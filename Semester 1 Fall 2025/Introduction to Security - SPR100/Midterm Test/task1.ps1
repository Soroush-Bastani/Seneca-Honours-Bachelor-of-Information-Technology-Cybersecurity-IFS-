param([Parameter(Mandatory=$true)][string]$x)
function e($m){Write-Output $m;exit 1}
if($x -notmatch '^[0-9]+$'){e('ERROR: Student number must contain digits only')}
try{$o=gcim Win32_OperatingSystem;$c=gcim Win32_ComputerSystem;$d=gcim Win32_LogicalDisk -Filter 'DriveType=3'}catch{e('ERROR: Unable to query system information')}
$s=($d|measure Size -Sum).Sum
$h=[ordered]@{}
$k1=([char[]](0x68,0x6f,0x73,0x74,0x6e,0x61,0x6d,0x65)-join'')
$k2=([char[]](0x6f,0x73,0x5f,0x6e,0x61,0x6d,0x65)-join'')
$k3=([char[]](0x75,0x73,0x65,0x72,0x6e,0x61,0x6d,0x65)-join'')
$k4=([char[]](0x63,0x70,0x75,0x5f,0x63,0x6f,0x75,0x6e,0x74,0x5f,0x6c,0x6f,0x67,0x69,0x63,0x61,0x6c)-join'')
$k5=([char[]](0x6d,0x65,0x6d,0x6f,0x72,0x79,0x5f,0x74,0x6f,0x74,0x61,0x6c,0x5f,0x62,0x79,0x74,0x65,0x73)-join'')
$k6=([char[]](0x64,0x69,0x73,0x6b,0x5f,0x74,0x6f,0x74,0x61,0x6c,0x5f,0x62,0x79,0x74,0x65,0x73)-join'')
$k7=([char[]](0x73,0x74,0x75,0x64,0x65,0x6e,0x74,0x5f,0x6e,0x75,0x6d,0x62,0x65,0x72)-join'')
$h[$k1]=$env:COMPUTERNAME
$h[$k2]=$o.Caption
$h[$k3]=$env:USERNAME
$h[$k4]=[int]$c.NumberOfLogicalProcessors
$h[$k5]=[long]$c.TotalPhysicalMemory
$h[$k6]=[long]$s
$h[$k7]=$x
$j=$h|ConvertTo-Json -Depth 3
$t=[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes($j))
$t

